@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}






@model EmmascoTravelsApp1.Models.Package

<div class="container mt-5">
    <!-- Package Title & Image -->
    <div class="row">
        <div class="col-md-12 text-center">
            <h2 class="fw-bold">@Model.Name</h2>
            <img src="@Model.ImageUrl" alt="@Model.Name" 
                 class="img-fluid mx-auto d-block rounded shadow"
                 style="max-height: 400px; object-fit: cover;">
        </div>
    </div>

    <div class="row mt-4">
        <!-- Left: Details -->
        <div class="col-md-8">
            <h4 class="fw-bold">Package Details</h4>
            <p class="text-muted">@Model.Description</p>

            <ul class="list-group mb-3">
                <li class="list-group-item"><strong>Country:</strong> @Model.Country</li>
                <li class="list-group-item"><strong>Duration:</strong> @Model.Duration</li>
                <li class="list-group-item"><strong>Accommodation:</strong> @Model.Accommodation</li>
                <li class="list-group-item"><strong>Meals:</strong> @Model.Meals</li>
                <li class="list-group-item"><strong>Transport:</strong> @Model.Transport</li>
                <li class="list-group-item"><strong>Activities:</strong> @Model.Activities</li>
            </ul>

            <p class="fw-bold fs-4 mt-3">
                Price: @Model.Price.ToString("C0", System.Globalization.CultureInfo.GetCultureInfo("en-US"))
            </p>

        </div>

        <!-- Right: Map -->
        <div class="col-md-4">
            <h4 class="fw-bold">Location</h4>
            <iframe 
                src="https://www.google.com/maps?q=@Model.Country&output=embed" 
                width="100%" height="250" style="border:0;" allowfullscreen="">
            </iframe>

            <!-- Quick Help -->
            <div class="alert alert-info mt-3 rounded-4 shadow-sm small">
                <strong>💡 Tip:</strong> Book early to get the best deals on @Model.Country trips!
            </div>
        </div>
    </div>

    <!-- Extra Info -->
    <div class="row mt-5">
        <div class="col-md-12">
            <h4 class="fw-bold text-success">Why Choose This Package?</h4>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">Guided tours with local experts</li>
                <li class="list-group-item">Flexible payment options</li>
                <li class="list-group-item">24/7 customer support</li>
                <li class="list-group-item">Free cancellation up to 48 hours before travel</li>
            </ul>
        </div>
    </div>

    <!-- FAQ Section -->
    <div class="row mt-5">
        <div class="col-md-12">
            <h4 class="fw-bold text-primary mb-3">Frequently Asked Questions</h4>
            <div class="accordion" id="faqAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="faqOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">
                            What is included in the package price?
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            The price includes accommodation, meals as specified, transport, and guided activities. Flights may be separate unless stated.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="faqTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo">
                            Can I cancel or reschedule my booking?
                        </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Yes, free cancellations are allowed up to 48 hours before your trip. Rescheduling is also possible depending on availability.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="faqThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree">
                            Are there discounts for group bookings?
                        </button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Yes, group discounts apply when booking for 5 or more people. Contact our support team for a tailored offer.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    



    <!-- Reviews Section -->
    <div class="row mt-5">
        <div class="col-md-12">
            <h4 class="fw-bold text-warning mb-3">Reviews</h4>

            <!-- Show existing reviews -->
            @if (Model.Reviews != null && Model.Reviews.Any())
            {
                foreach (var review in Model.Reviews.OrderByDescending(r => r.Date))
                {
                    <div class="card mb-3 shadow-sm">
                        <div class="card-body">
                            <h6 class="card-title fw-bold">
                                @review.ReviewerName
                                <small class="text-muted">(@review.Date.ToShortDateString())</small>
                            </h6>
                            <p>
                                @for (int i = 0; i < review.Rating; i++)
                                {
                                    <span class="text-warning">★</span>
                                }
                                @for (int i = review.Rating; i < 5; i++)
                                {
                                    <span class="text-muted">★</span>
                                }
                            </p>
                            <p class="card-text">@review.Comment</p>
                        </div>
                    </div>
                }
            }
            else
            {
                <p class="text-muted">No reviews yet. Be the first to leave one!</p>
            }

            <!-- Add review form -->
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="fw-bold">Leave a Review</h5>
                    <form asp-action="AddReview" method="post">
                        <input type="hidden" name="packageId" value="@Model.Id" />

                        <div class="mb-3">
                            <label class="form-label"> Your Name</label>
                            <input type="text" name="reviewerName" class="form-control" required />
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Rating</label>
                            <select name="rating" class="form-select" required>
                                <option value="">-- Select --</option>
                                <option value="5">★★★★★ (5)</option>
                                <option value="4">★★★★ (4)</option>
                                <option value="3">★★★ (3)</option>
                                <option value="2">★★ (2)</option>
                                <option value="1">★ (1)</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Comment</label>
                            <textarea name="comment" class="form-control" rows="3" required></textarea>
                        </div>

                        <button type="submit" class="btn btn-success">Submit Review</button>
                    </form>
                </div>
            </div>
        </div>
    </div>








    <!-- Action Buttons -->
    <div class="mt-4 d-flex flex-wrap gap-2 mb-5">
        <a asp-controller="Booking" asp-action="Create" asp-route-packageId="@Model.Id"
           class="btn btn-primary">
            🛒 Book Now
        </a>
    </div>
</div>
